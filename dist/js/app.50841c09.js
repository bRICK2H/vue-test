(function(e){function t(t){for(var o,i,a=t[0],c=t[1],u=t[2],_=0,f=[];_<a.length;_++)i=a[_],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);l&&l(t);while(f.length)f.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],o=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(o=!1)}o&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={app:0},s=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/vue-test/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"065d":function(e,t,n){"use strict";n("53e9")},"0be7":function(e,t,n){"use strict";n("9c67")},"3e24":function(e,t,n){e.exports=n.p+"img/minus.41021aa0.svg"},"404b":function(e,t,n){},"53e9":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrapper"},[n("main",{staticClass:"main"},[n("c-button-add"),n("c-user-list")],1),n("c-modal")],1)},s=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"modal"}},[e.GET_IS_MODAL?n("div",{staticClass:"modal",on:{click:function(t){return t.target!==t.currentTarget?null:e.CLOSE_MODAL(t)}}},[n("div",{staticClass:"content modal__content"},[n("button",{staticClass:"close-modal content__close-modal",style:e.getStyleIconClose,on:{click:e.CLOSE_MODAL}}),n("c-form")],1)]):e._e()])},a=[],c=n("5530"),u=n("2f62"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"form",attrs:{novalidate:""},on:{submit:function(t){return t.preventDefault(),e.saveUser(t)}}},[n("fieldset",{staticClass:"form__group"},[n("legend",{staticClass:"form__title"},[e._v(" Добавление пользователя ")]),n("c-form-name"),n("c-form-phone"),n("c-form-chief"),n("c-form-button-save")],1)])},_=[],f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field-box form__field-box"},[n("p",{directives:[{name:"show",rawName:"v-show",value:e.GET_IS_SENDING_FORM&&e.GET_FIELD_NAME("isError"),expression:"GET_IS_SENDING_FORM && GET_FIELD_NAME('isError')"}],staticClass:"field-box__error"},[e._v(" "+e._s(e.GET_FIELD_NAME("errorMsg"))+" ")]),n("label",{staticClass:"field-box__label",attrs:{for:"name"}},[e._v(" Имя* ")]),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.name,expression:"name",modifiers:{trim:!0}}],staticClass:"field-item field-box__field-item",class:[e.GET_CLASS_FIELD_ERROR("name"),e.GET_CLASS_FIELD_SUCCESS("name")],attrs:{autocomplete:"off",placeholder:"Денис",id:"name",type:"text"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])},E=[],S={name:"cFormName",computed:Object(c["a"])(Object(c["a"])({},Object(u["c"])("form",["GET_FIELD_NAME","GET_IS_SENDING_FORM","GET_CLASS_FIELD_ERROR","GET_CLASS_FIELD_SUCCESS"])),{},{name:{get:function(){return this.GET_FIELD_NAME("value")},set:function(e){this.SET_NAME(e)}}}),methods:Object(u["b"])("form",["SET_NAME"])},m=S,d=n("2877"),p=Object(d["a"])(m,f,E,!1,null,null,null),O=p.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field-box form__field-box"},[n("p",{directives:[{name:"show",rawName:"v-show",value:e.GET_IS_SENDING_FORM&&e.GET_FIELD_PHONE("isError"),expression:"GET_IS_SENDING_FORM && GET_FIELD_PHONE('isError')"}],staticClass:"field-box__error"},[e._v(" "+e._s(e.GET_FIELD_PHONE("errorMsg"))+" ")]),n("label",{staticClass:"field-box__label",attrs:{for:"phone"}},[e._v(" Телефон* ")]),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.phone,expression:"phone",modifiers:{trim:!0}}],staticClass:"field-item field-box__field-item",class:[e.GET_CLASS_FIELD_ERROR("phone"),e.GET_CLASS_FIELD_SUCCESS("phone")],attrs:{autocomplete:"off",placeholder:"+79779991178",id:"phone",type:"text"},domProps:{value:e.phone},on:{"~click":function(t){return e.SET_PHONE("+7")},"~focus":function(t){return e.SET_PHONE("+7")},input:function(t){t.target.composing||(e.phone=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])},h=[],T={name:"cFormPhone",computed:Object(c["a"])(Object(c["a"])({},Object(u["c"])("form",["GET_FIELD_PHONE","GET_IS_SENDING_FORM","GET_CLASS_FIELD_ERROR","GET_CLASS_FIELD_SUCCESS"])),{},{phone:{get:function(){return this.GET_FIELD_PHONE("value")},set:function(e){this.SET_PHONE(e)}}}),methods:Object(u["b"])("form",["SET_PHONE"])},v=T,C=Object(d["a"])(v,b,h,!1,null,null,null),g=C.exports,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field-box form__field-box"},[n("label",{staticClass:"field-box__label",attrs:{for:""}},[e._v("Начальник")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.selectChief,expression:"selectChief"}],staticClass:"field-item field-box__field-item",attrs:{name:"",id:""},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectChief=t.target.multiple?n:n[0]}}},[n("option",{attrs:{selected:""},domProps:{value:null}},[e._v("нет")]),e._l(e.GET_USERS,(function(t){return n("option",{key:t.id,domProps:{value:[t]}},[e._v(" "+e._s(t.name)+" ")])}))],2)])},I=[],N={name:"cFormChief",computed:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(u["c"])("form",["GET_SELECTED_CHIEF"])),Object(u["c"])("users",["GET_USERS"])),{},{selectChief:{get:function(){return this.GET_SELECTED_CHIEF("value")},set:function(e){this.SET_SELECTED_CHIEF(e)}}}),methods:Object(u["b"])("form",["SET_SELECTED_CHIEF"])},D=N,F=Object(d["a"])(D,R,I,!1,null,null,null),L=F.exports,A=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},M=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"button-box form__button-box"},[n("button",{staticClass:"button button--color"},[e._v("Сохнарить")])])}],y={name:"cFormButtonSave"},G=y,j=(n("065d"),Object(d["a"])(G,A,M,!1,null,"1890f86c",null)),P=j.exports,w={name:"cForm",components:{cFormName:O,cFormPhone:g,cFormChief:L,cFormButtonSave:P},methods:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(u["b"])(["CLOSE_MODAL"])),Object(u["b"])("form",["SET_IS_SENDING_FORM","CHECK_VALIDATE_FORM","DROP_STATE_FORM","ADD_USER"])),{},{saveUser:function(){var e=this;this.SET_IS_SENDING_FORM(),this.CHECK_VALIDATE_FORM({required:["name","phone"]}).then((function(t){t&&(e.ADD_USER(),e.CLOSE_MODAL())}))}}),beforeDestroy:function(){this.DROP_STATE_FORM()}},x=w,U=(n("0be7"),Object(d["a"])(x,l,_,!1,null,null,null)),H=U.exports,k={name:"cModal",components:{cForm:H},data:function(){return{iconClose:n("8b1b")}},computed:Object(c["a"])(Object(c["a"])({},Object(u["c"])(["GET_IS_MODAL"])),{},{getStyleIconClose:function(){return{"background-image":"url(".concat(this.iconClose,")")}}}),methods:Object(u["b"])(["CLOSE_MODAL"]),created:function(){var e=this;document.addEventListener("keydown",(function(t){27===t.keyCode&&e.CLOSE_MODAL()}))}},$=k,V=(n("813e"),Object(d["a"])($,i,a,!1,null,null,null)),Y=V.exports,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"button main__button button--color",on:{click:e.OPEN_MODAL}},[e._v(" Добавить ")])},J=[],q={name:"cButtonAdd",methods:Object(u["b"])(["OPEN_MODAL"])},K=q,X=(n("e941"),Object(d["a"])(K,B,J,!1,null,"4e8caca7",null)),z=X.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{staticClass:"table"},[n("thead",[n("tr",{staticClass:"table__header-row"},[n("th",{staticClass:"header-cell table__header-cell"},[n("span",{staticClass:"header-cell__item",on:{click:function(t){return e.SORT_USERS("name")}}},[e._v(" Имя "),n("span",{staticClass:"header-cell__icon-name",style:e.getStyleIconSortName})]),n("span",{staticClass:"header-cell__item",on:{click:function(t){return e.SORT_USERS("phone")}}},[e._v(" Телефон "),n("span",{staticClass:"header-cell__icon-phone",style:e.getStyleIconSortPhone})])])])]),n("tbody",e._l(e.GET_USERS,(function(e){return n("c-user",{key:e.id,attrs:{user:e}})})),1)])},W=[],Z=(n("b0c0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",{staticClass:"body-row table__body-row"},[n("td",{staticClass:"body-cell body-row__body-cell",class:e.getClassNestedRow},[n("span",{staticClass:"body-cell__item",class:e.getClassNestedCell},[n("span",{staticClass:"button-cell-box body-cell__button-cell-box"},[e.user.chief?n("button",{staticClass:"button-cell-box__toggle-chief",style:e.getStyleNestedButton,on:{click:function(t){e.isShowChief=!e.isShowChief}}}):e._e()]),e._v(" "+e._s(e.user.name)+" ")]),n("span",{staticClass:"body-cell__item",class:e.getClassNestedCell},[e._v(" "+e._s(e.user.phone)+" ")])]),n("transition",{attrs:{name:"show-chief"}},[n("td",{directives:[{name:"show",rawName:"v-show",value:e.user.chief&&e.isShowChief,expression:"user.chief && isShowChief"}],staticClass:"body-cell body-row__body-cell"},[n("table",{staticClass:"table"},[n("tbody",e._l(e.user.chief,(function(e){return n("c-user",{key:e.id,staticClass:"body-row table__body-row",attrs:{user:e}})})),1)])])])],1)}),ee=[],te={name:"cUser",props:{user:{type:Object,require:!0}},data:function(){return{isShowChief:!1,iconMinus:n("3e24"),iconPlus:n("eb38")}},computed:{getClassNestedRow:function(){return{"body-cell--nested":this.user.chief}},getClassNestedCell:function(){return{"body-cell__item--nested":this.user.chief}},getStyleNestedButton:function(){return this.isShowChief?"background-image:url('".concat(this.iconMinus,"')"):"background-image:url('".concat(this.iconPlus,"')")}}},ne=te,oe=(n("a8e0"),Object(d["a"])(ne,Z,ee,!1,null,null,null)),re=oe.exports,se={name:"cUserList",components:{cUser:re},data:function(){return{iconUp:n("5c5b"),iconDown:n("d8aa")}},computed:Object(c["a"])(Object(c["a"])({},Object(u["c"])("users",["GET_USERS","GET_IS_TYPE_OF_SORT"])),{},{getStyleIconSortName:function(){return this.GET_IS_TYPE_OF_SORT["name"]?"background-image:url('".concat(this.iconDown,"')"):"background-image:url('".concat(this.iconUp,"')")},getStyleIconSortPhone:function(){return this.GET_IS_TYPE_OF_SORT["phone"]?"background-image:url('".concat(this.iconDown,"')"):"background-image:url('".concat(this.iconUp,"')")}}),methods:Object(u["b"])("users",["FETCH_USERS","SORT_USERS"]),created:function(){this.FETCH_USERS()}},ie=se,ae=(n("8432"),Object(d["a"])(ie,Q,W,!1,null,null,null)),ce=ae.exports,ue={name:"App",components:{cModal:Y,cButtonAdd:z,cUserList:ce}},le=ue,_e=(n("5c0b"),Object(d["a"])(le,r,s,!1,null,null,null)),fe=_e.exports,Ee=(n("d81d"),n("2909")),Se=n("e88e"),me=new o["a"],de={namespaced:!0,state:{users:[],isTypeOfSort:{name:!1,phone:!0}},getters:{GET_USERS:function(e){return e.users},GET_NEXT_USER_ID:function(e){return Math.max.apply(Math,Object(Ee["a"])(e.users.map((function(e){return e.id}))))+1},GET_IS_TYPE_OF_SORT:function(e){return e.isTypeOfSort}},mutations:{SET_SAVING_USER:function(e,t){return e.users.push(t)},SET_SAVING_USERS:function(e,t){t?me.$set(e,"users",JSON.parse(t)):me.$set(e,"users",Se)},SET_STATE_TYPE_OF_SORT:function(e,t){t?me.$set(e,"isTypeOfSort",JSON.parse(t)):me.$set(e,"isTypeOfSort",{name:!1,phone:!0})},SET_SORTING_USERS:function(e,t){e.isTypeOfSort[t]=!e.isTypeOfSort[t],e.users.sort((function(n,o){var r=n[t],s=o[t];switch(t){case"name":case"phone":return e.isTypeOfSort[t]?r.localeCompare(s):s.localeCompare(r)}}))}},actions:{SAVE_USER:function(e,t){var n=e.commit,o=e.getters,r=o.GET_NEXT_USER_ID;n("SET_SAVING_USER",Object(c["a"])({id:r},t))},FETCH_USERS:function(e){var t=e.commit,n=localStorage.getItem("CURR_USERS"),o=localStorage.getItem("STATE_TYPE_OF_SORT");t("SET_SAVING_USERS",n),t("SET_STATE_TYPE_OF_SORT",o)},SORT_USERS:function(e,t){var n=e.commit;return n("SET_SORTING_USERS",t)}}},pe=(n("a623"),n("13d5"),n("4fad"),n("ade3")),Oe=n("3835"),be={getters:{GET_FIELD_NAME:function(e,t,n){return function(e){var t=n.form.fields.name;return t[e]}}},mutations:{SET_NAME:function(e,t){var n=t.name,o=t.value;return n.value=o},SET_VALIDATE_NAME:function(e,t){var n=t.name,o=t.value,r=function(e,t){n.isError=e,n.errorMsg=t};Boolean(o)?/^[А-Яа-яЁё]+$/.test(o)?r(!1,""):r(!0,"Разрешены только буквы кириллицы!"):r(!0,"Имя обязательно к заполнению!")}},actions:{SET_NAME:function(e,t){var n=e.commit,o=e.rootState,r=o.form.fields.name;n("SET_VALIDATE_NAME",{name:r,value:t}),n("SET_NAME",{name:r,value:t})}}},he=(n("a15b"),n("a434"),{getters:{GET_FIELD_PHONE:function(e,t,n){return function(e){var t=n.form.fields.phone;return t[e]}}},mutations:{SET_PHONE:function(e,t){var n=t.phone,o=t.value;if(n.value=o,12===n.value.length){for(var r=Object(Ee["a"])(n.value),s=[],i=0;i<4;i++)i<2?s.unshift(" ".concat(r.splice(-2).join(""))):s.unshift(" ".concat(r.splice(-3).join("")));n.value=r.join("")+s.join("")}},SET_VALIDATE_PHONE:function(e,t){var n=t.phone,o=t.value,r=function(e,t){n.isError=e,n.errorMsg=t};Boolean(o)?/^\+7{1} ?[0-9]{3} ?[0-9]{3} ?[0-9]{2} ?[0-9]{2}$/.test(o)?r(!1,""):r(!0,"Введены не корректные значения!"):r(!0,"Телефон обязателен к заполнению!")}},actions:{SET_PHONE:function(e,t){var n=e.commit,o=e.rootState,r=o.form.fields.phone;n("SET_VALIDATE_PHONE",{phone:r,value:t}),n("SET_PHONE",{phone:r,value:t})}}}),Te={getters:{GET_SELECTED_CHIEF:function(e,t,n){return function(e){var t=n.form.fields.chief;return t[e]}}},mutations:{SET_SELECTED_CHIEF:function(e,t){var n=t.chief,o=t.value;return n.value=o}},actions:{SET_SELECTED_CHIEF:function(e,t){var n=e.commit,o=e.rootState,r=o.form.fields.chief;n("SET_SELECTED_CHIEF",{chief:r,value:t})}}},ve=function(){return{isSendingForm:!1,fields:{name:{value:"",errorMsg:"Имя обязательно к заполнению!",isError:!0},phone:{value:"",errorMsg:"Телефон обязателен к заполнению!",isError:!0},chief:{value:null}}}},Ce=ve(),ge={namespaced:!0,modules:{name:be,phone:he,chief:Te},state:Ce,getters:{GET_IS_SENDING_FORM:function(e){return e.isSendingForm},GET_CLASS_FIELD_ERROR:function(e){return function(t){return{"field-item--error":e.fields[t].isError&&e.isSendingForm}}},GET_CLASS_FIELD_SUCCESS:function(e){return function(t){return{"field-item--success":!e.fields[t].isError&&e.isSendingForm}}}},mutations:{SET_IS_SENDING_FORM:function(e){return e.isSendingForm=!0},SET_DROP_STATE_FORM:function(e){return Object.assign(e,ve())}},actions:{SET_IS_SENDING_FORM:function(e){var t=e.commit;return t("SET_IS_SENDING_FORM")},DROP_STATE_FORM:function(e){var t=e.commit;return t("SET_DROP_STATE_FORM")},CHECK_VALIDATE_FORM:function(e,t){var n=e.state,o=t.required;return o.map((function(e){return n.fields[e].isError})).every((function(e){return!1===e}))},ADD_USER:function(e){var t=e.dispatch,n=e.state,o=Object.entries(n.fields).reduce((function(e,t){var n=Object(Oe["a"])(t,2),o=n[0],r=n[1];return Object.assign(e,Object(pe["a"])({},o,r.value)),e}),{});t("users/SAVE_USER",o,{root:!0})}}},Re={state:{isModal:!1},getters:{GET_IS_MODAL:function(e){return e.isModal}},mutations:{SET_OPEN_MODAL:function(e){return e.isModal=!0},SET_CLOSE_MODAL:function(e){return e.isModal=!1}},actions:{OPEN_MODAL:function(e){var t=e.commit;return t("SET_OPEN_MODAL")},CLOSE_MODAL:function(e){var t=e.commit;return t("SET_CLOSE_MODAL")}}};o["a"].use(u["a"]);var Ie=new u["a"].Store({modules:{users:de,form:ge,modal:Re}});o["a"].config.productionTip=!1,new o["a"]({store:Ie,render:function(e){return e(fe)}}).$mount("#app"),window.addEventListener("beforeunload",(function(e){var t=JSON.stringify(Ie.getters["users/GET_USERS"]),n=JSON.stringify(Ie.getters["users/GET_IS_TYPE_OF_SORT"]);localStorage.setItem("CURR_USERS",t),localStorage.setItem("STATE_TYPE_OF_SORT",n)}))},"5c0b":function(e,t,n){"use strict";n("9c0c")},"5c5b":function(e,t,n){e.exports=n.p+"img/up.eef73da9.svg"},"813e":function(e,t,n){"use strict";n("404b")},8432:function(e,t,n){"use strict";n("a400")},"8b1b":function(e,t,n){e.exports=n.p+"img/close.40000a14.svg"},"9c0c":function(e,t,n){},"9c67":function(e,t,n){},a400:function(e,t,n){},a8e0:function(e,t,n){"use strict";n("f9c3")},d8aa:function(e,t,n){e.exports=n.p+"img/down.f1442fed.svg"},e88e:function(e){e.exports=JSON.parse('[{"id":1,"name":"Марина","phone":"+7 941 123 21 41","chief":null},{"id":2,"name":"Пётр","phone":"+7 941 123 21 42","chief":null},{"id":3,"name":"Алексей","phone":"+7 941 123 21 43","chief":[{"id":0,"name":"Иван","phone":"+7 941 123 21 40","chief":[{"id":1,"name":"Марина","phone":"+7 941 123 21 41","chief":null}]}]},{"id":4,"name":"Борис","phone":"+7 941 123 21 44","chief":null}]')},e941:function(e,t,n){"use strict";n("f497")},eb38:function(e,t,n){e.exports=n.p+"img/plus.cdee8ab3.svg"},f497:function(e,t,n){},f9c3:function(e,t,n){}});
//# sourceMappingURL=app.50841c09.js.map